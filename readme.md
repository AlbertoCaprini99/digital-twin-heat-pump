# Digital Twin for Heat Pump Predictive Maintenance

[![MATLAB](https://img.shields.io/badge/MATLAB-R2023b-orange.svg)](https://www.mathworks.com/products/matlab.html)

> A hybrid digital twin system combining physics-based modeling and machine learning for predictive maintenance of heat pump systems.

---

## ğŸ“‹ Table of Contents

- [Overview](#overview)
- [Key Features](#key-features)
- [System Architecture](#system-architecture)
- [Performance Metrics](#performance-metrics)
- [How It Works](#how-it-works)
- [Contact](#contact)

---

## ğŸ¯ Overview

This project implements a **Digital Twin** for air-source heat pumps designed to enable predictive maintenance and fault detection. The system combines:

- **Physics-based modeling** using MATLAB Simscape for thermodynamic simulation
- **Machine learning** with neural networks for anomaly detection
- **Real-time diagnostics** through an intuitive GUI interface

The digital twin can predict system behavior, detect anomalies, and diagnose specific faults such as refrigerant leakage and condenser fouling before they lead to system failures.

### ğŸ“ Academic Context

This project was developed as part of my **Master's Thesis** in Mechanical Engineering at the University of Padua in collaboration with Aermec Spa's R&D department.

---

## âœ¨ Key Features

### ğŸ”¬ Physics-Based Modeling
- Thermodynamic model of complete vapor-compression cycle
- Component-level simulation (compressor, evaporator, condenser, expansion valve)
- High accuracy: **RMSE < 3K** for temperatures, **< 7%** for pressures and powers
- Validated across multiple operating conditions

### ğŸ§  Machine Learning Integration
- Neural network trained on 1000+ synthetic scenarios generated by the Physics-Based Model
- Hybrid modeling approach combining physics and data-driven methods
- Fast inference (< 50ms) for real-time diagnostics

### ğŸš¨ Fault Detection & Diagnosis
- **Refrigerant leakage detection**: identifies undercharge â‰¥ 10%

### ğŸ’» User Interface
- MATLAB GUI for non-technical users
- Real-time visualization of system state
- Alert system with severity levels
- PDF report generation

---

## ğŸ—ï¸ System Architecture

                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  Physical Layer  â”‚
                     â”‚                  â”‚
                     â”‚  â€¢ Simscape      â”‚
                     â”‚  â€¢ Thermodynamicsâ”‚
                     â”‚  â€¢ Components    â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  Synthetic Database â”‚
                     â”‚                     â”‚
                     â”‚  â€¢ 1000+ simulationsâ”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  Neural Network  â”‚
                     â”‚                  â”‚
                     â”‚  â€¢ Matlab        â”‚
                     â”‚  â€¢ Training      â”‚
                     â”‚  â€¢ Testing       â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


### Components Details

#### 1. Physical Layer (Simscape Model)
- **Compressor**: Scroll compressor with volumetric and isentropic efficiency maps
- **Evaporator**: Plate heat exchanger with finite volume discretization
- **Condenser**: Finned-tube heat exchanger with air-side modeling
- **Expansion Valve**: Electronic expansion valve with controllable opening

#### 2. ML Layer (Neural Network)
- **Architecture**: 2-layer feedforward network 
- **Input**: 4 features (operating conditions)
- **Output**: 10+ features (pressure, temperatures, powers)
- **Training**: 1000+ synthetic samples under different oeprating conditions

---

## ğŸ“Š Performance Metrics

### Model Accuracy

| Metric | Value | Notes |
|--------|--------|--------|
| **Temperature RMSE** | 0.31â€“3.02 K | Always < 3.1 K (max at condenser inlet, min at evaporator outlet) |
| **Pressure RMSE** | 0.118â€“0.949 bar | Always < 0.95 bar (â‰ˆ5.2% RRMSE) |
| **Evaporator Power RMSE** | 960 W | â‰ˆ 6.9% relative error |
| **Compressor Power RMSE** | 195 W | â‰ˆ 5.5% relative error |
| **Operating Range Sensitivity** | Accuracy decreases outside nominal envelope | Digital twin less reliable off-design |

### Fault Detection Performance

| Fault Type | Detection Threshold | Notes |
|-----------|----------------------|--------|
| **Refrigerant Leakage** | Detectable from â‰¥ 20% loss | <10% loss cannot be detected |
| **Fouling / Blockages** | Detectable only with significant impact | Minor anomalies remain undetected |
| **General Behavior** | Detects deviation from nominal values | Requires operator interpretation |

### Computational Performance

- **Simscape simulation**: ~30 seconds per scenario  
- **Neural network inference**: < 50 ms   

---

## ğŸ” How It Works

### Step 1: Physical Modeling

The Simscape model simulates the thermodynamic behavior of the heat pump:

1. **Refrigerant cycle**: R410A properties from REFPROP database
2. **Energy balance**: Conservation of mass and energy at each component
3. **Heat transfer**: Correlations for convection and phase change
4. **Control logic**: PID controllers for superheat and subcooling

### Step 2: Data Generation

The physical model generates training data:

- **Nominal conditions**: 1,000 scenarios across operating range
- **Fault scenarios**: 36 experimental tests under different operating conditions and refrigerant undercharge from 10% to 40%

### Step 3: Neural Network Training

```matlab
% Pseudo-code for training pipeline
data = generate_training_data(physical_model, n_samples=10000);
[X_train, X_val, X_test] = split_data(data, [0.7, 0.15, 0.15]);

net = create_neural_network([128, 64, 32]);
net = train_network(net, X_train, X_val, ...
                     epochs=200, ...
                     optimizer='adam', ...
                     learning_rate=0.001);

performance = evaluate(net, X_test);
```

### Step 4: Real-Time Inference

1. Sensor data is fed to the neural network
2. Neural network provides detailed component-level insights
3. Neural network provides fast anomaly detection
4. Results are displayed in the GUI

---

## ğŸ“§ Contact

**Alberto Caprini**
- ğŸ“§ Email: albertocaprini99@gmail.com
- ğŸ’¼ LinkedIn: [linkedin.com/in/albertocaprini](https://www.linkedin.com/in/albertocaprini)
- ğŸŒ Portfolio: [yourusername.github.io](https://yourusername.github.io)

**Project Link**: [https://github.com/yourusername/digital-twin-heat-pump](https://github.com/yourusername/digital-twin-heat-pump)

---

## ğŸ™ Acknowledgments

- **Aermec Spa** - R&D Department for providing resources and test facilities
- **University of Padua** - Department of Industrial Engineering for academic supervision
- **Advisor**: Prof. [Benini] - For guidance and support throughout the project
- **Colleagues** at Aermec for technical discussions and feedback

---

## ğŸ“š References

If you use this work in your research, please cite:

```bibtex
@mastersthesis{caprini2024digital,
  title={Digital Twin for Heat Pump Predictive Maintenance: 
         A Hybrid Physics-ML Approach},
  author={Caprini, Alberto},
  year={2024},
  school={University of Padua},
  type={Master's Thesis}
}
```
---

<div align="center">

**â­ If you find this project useful, please consider giving it a star! â­**

Made with â¤ï¸ by Alberto Caprini

</div>
